<div class="well">
  <div class="btn-groupy">
    <button id="run" role="button" class="btn btn-success">
      <i class="fa fa-play"></i>
      Run Weather Simulation
    </button>
    <button id="step" role="button" class="btn btn-warning">
      <i class="fa fa-step-forward"></i>
      Step Weather Simulation
    </button>
    <button id="save" role="button" class="btn btn-info">
      <i class="fa fa-floppy-o"></i>
      Save weather
    </button>
    <span id='message' class="alert"></span>
  </div>

  <div class="row">
    <div id="blockly-editor" data-model-type="weather" data-model-url="<%= url_for(@weather) %>" class="col-md-9" style="height: 80%;"></div>
    <div id="blockly-iopanel" class="col-md-3">
      <ul class="list-group">

        <li class="list-group-item list-group-item-header">
          <h4>Inputs</h4>
        </li>

        <%= io_item "simulation_year", "simulation year", 0, as: :number %>
        <%= io_item "simulation_month", "simulation month", 0, as: :number %>
        <%= io_item "simulation_day", "simulation day", 0, as: :number %>

        <li class="list-group-item">
          <input id="elapsed_time" type="number" value="0" class="pull-right">
          Elapsed simulation time (minutes)
        </li>

        <li class="list-group-item">
          <input id="latitude" type="number" value="0" class="pull-right">
          Latitude
        </li>
        <li class="list-group-item">
          <input id="longitude" type="number" value="0" class="pull-right">
          Longitude
        </li>


        <li class="list-group-item list-group-item-header">
          <h4>Outputs</h4>
        </li>

        <%= io_item "rainfall", "rain (mm)", 0, as: :number %>
        <%= io_item "snowfall", "snow (mm)", 0, as: :number %>

        <%= io_item "average_temperature", "average temperature (&deg;C)", 0, as: :number %>
        <%= io_item "low_temperature", "low temperature (&deg;C)", 0, as: :number %>
        <%= io_item "high_temperature", "high temperature (&deg;C)", 0, as: :number %>

        <%= io_item "wind_speed", "wind speed (m/s)", 0, as: :number %>
        <%= io_item "wind_direction", "wind direction (compass degrees)", 0, as: :number %>

        <%= io_item "relative_humidity", "relative humidity (%)", 0, as: :number %>

      </ul>
    </div>
  </div>

  <xml id="toolbox" style="display: none">

    <category name="Simulation">
      <block type="simulation_elapsed_time"></block>
      <block type="simulation_every_timestep"></block>
      <block type="simulation_get_date"></block>
    </category>

    <category name="Weather">
      <block type="weather_set_precipitation"></block>
      <block type="weather_get_precipitation"></block>
      <block type="weather_set_temperature"></block>
      <block type="weather_get_temperature"></block>
      <block type="weather_set_wind_speed"></block>
      <block type="weather_get_wind_speed"></block>
      <block type="weather_set_wind_direction"></block>
      <block type="weather_get_wind_direction"></block>
      <block type="weather_set_relative_humidity"></block>
      <block type="weather_get_relative_humidity"></block>
    </category>

    <category name="Logic">
      <block type="logic_compare"></block>
      <block type="logic_operation"></block>
      <block type="logic_negate"></block>
      <block type="logic_boolean"></block>
      <block type="logic_null"></block>
      <block type="controls_if"></block>
      <block type="controls_if"><mutation else="1"></mutation></block>
      <block type="controls_if"><mutation elsif="1" else="1"></mutation></block>      
      <block type="logic_ternary"></block>
    </category>

    <category name="Loops">
      <block type="controls_repeat_ext"></block>
      <block type="controls_whileUntil"></block>
      <block type="controls_for"></block>
      <block type="controls_forEach"></block>
      <block type="controls_flow_statements"></block>
    </category>

    <category name="Math">
      <block type="math_number"></block>
      <block type="math_arithmetic"></block>
      <block type="math_single"></block>
      <block type="math_trig"></block>
      <block type="math_constant"></block>
      <block type="math_number_property"></block>
      <block type="math_change"><value name="DELTA"><block type="math_number"><field name="NUM">1</field></block></value></block>
      <block type="math_round"></block>
      <block type="math_on_list"></block>
      <block type="math_modulo"></block>
      <block type="math_constrain"></block>
      <block type="math_random_int"></block>
      <block type="math_random_float"></block>
    </category>

    <category name="Text">
      <block type="text"><field name="TEXT">Hello</field></block>
      <block type="text_print"></block>
    </category>

    <category name="Lists">
      <block type="lists_create_empty"></block>
      <block type="lists_create_with"></block>
      <block type="lists_repeat"></block>
      <block type="lists_length"></block>
      <block type="lists_isEmpty"></block>
      <block type="lists_indexOf"></block>
      <block type="lists_getIndex"></block>
      <block type="lists_setIndex"></block>
    </category>

    <category name="Variables" custom="VARIABLE">
    </category>

    <category name="Functions" custom="PROCEDURE">
    </category>

  </xml>

  <%= @weather.workspace.html_safe %>

</div>
